<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>VR Snowman</title>
    <style>
      body { margin: 0; overflow: hidden; }
      canvas { display: block; }
      #monoVRButton {
        position: absolute;
        top: 10px;
        left: 10px;
        padding: 10px 20px;
        background: #0077ff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
        z-index: 999;
      }
    </style>
  </head>
  <body>
    <button id="monoVRButton">Activar VR (1 sola vista)</button>
    <script type="module">
      import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.module.js';

      let camera, scene, renderer, snowman;

      init();
      animate();

      function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);

        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 1.6, 3); // ver desde fuera

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.xr.enabled = true;
        document.body.appendChild(renderer.domElement);

        // Luz
        const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1.2);
        light.position.set(0, 20, 0);
        scene.add(light);

        // Muñeco de nieve
        const material = new THREE.MeshStandardMaterial({ color: 0xffffff });
        const body = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), material);
        const head = new THREE.Mesh(new THREE.SphereGeometry(0.6, 32, 32), material);

        body.position.y = 1;
        head.position.y = 2.4;

        snowman = new THREE.Group();
        snowman.add(body);
        snowman.add(head);
        scene.add(snowman);

        window.addEventListener('resize', onWindowResize);

        // Botón VR personalizado
        const monoVRButton = document.getElementById('monoVRButton');
        monoVRButton.addEventListener('click', async () => {
          if (navigator.xr) {
            try {
              const session = await navigator.xr.requestSession('immersive-vr', { requiredFeatures: [] });
              renderer.xr.setSession(session);
            } catch (e) {
              console.error('Error iniciando VR:', e);
            }
          } else {
            alert('WebXR no soportado en este navegador');
          }
        });
      }

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      }

      function animate() {
        renderer.setAnimationLoop(() => {
          renderer.render(scene, camera);
        });
      }
    </script>
  </body>
</html>
